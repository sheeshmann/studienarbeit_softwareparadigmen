<!doctype html>
<html>
<head>
  <title>Übersicht</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      font-family: Arial, sans-serif;
    }
    main { flex: 1; }
    footer { margin-top: auto; padding: 10px 0; }

    ul { padding-left: 18px; }
    li { margin-bottom: 6px; }

    /* kleine Badges für RL-Status */
    .badge {
      display: inline-block;
      margin-left: 8px;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      line-height: 1;
      background: #eee;
    }
    .badge.unsicherheit { background: #ffe3e3; } /* rötlich */
    .badge.sicherheit   { background: #e6ffe6; } /* grünlich */

    /* Inline-Formulare für Buttons */
    form.inline { display: inline; margin-left: 6px; }
    form.inline button { padding: 2px 6px; }
  </style>
</head>
<body>
  <main>
    <h1>Übersicht</h1>
    <p><a href="{% url 'food-add' %}">Lebensmittel hinzufügen</a></p>

    <h2>Dein Vorrat</h2>

    <h3>- MHD &gt; 7 Tage</h3>
    <ul>
      {% for f in mhd_gt_7 %}
        <li>
          {{ f.name }} – {{ f.quantity }} – Ablauf: {{ f.expiration_date }}
          {% if f.badge %}
            <span class="badge {{ f.badge|lower }}">{{ f.badge }}</span>
          {% endif %}
          <form method="post" action="{% url 'food-change-qty' f.id '-1' %}" class="inline">
            {% csrf_token %}<button type="submit">−1</button>
          </form>
          <form method="post" action="{% url 'food-change-qty' f.id '1' %}" class="inline">
            {% csrf_token %}<button type="submit">+1</button>
          </form>
          <form method="post" action="{% url 'food-delete' f.id %}" class="inline"
                onsubmit="return confirm('Wirklich löschen?');">
            {% csrf_token %}<button type="submit" style="color:red">Löschen</button>
          </form>
        </li>
      {% empty %}<li>–</li>{% endfor %}
    </ul>

    <h3>- MHD &lt; 7 Tage</h3>
    <ul>
      {% for f in mhd_lt_7 %}
        <li>
          {{ f.name }} – {{ f.quantity }} – Ablauf: {{ f.expiration_date }}
          {% if f.badge %}
            <span class="badge {{ f.badge|lower }}">{{ f.badge }}</span>
          {% endif %}
          <form method="post" action="{% url 'food-change-qty' f.id '-1' %}" class="inline">
            {% csrf_token %}<button type="submit">−1</button>
          </form>
          <form method="post" action="{% url 'food-change-qty' f.id '1' %}" class="inline">
            {% csrf_token %}<button type="submit">+1</button>
          </form>
          <form method="post" action="{% url 'food-delete' f.id %}" class="inline"
                onsubmit="return confirm('Wirklich löschen?');">
            {% csrf_token %}<button type="submit" style="color:red">Löschen</button>
          </form>
        </li>
      {% empty %}<li>–</li>{% endfor %}
    </ul>

    <h3>- MHD seit 3 Tagen überschritten</h3>
    <ul>
      {% for f in expired_0_3 %}
        <li>
          {{ f.name }} – {{ f.quantity }} – Ablauf: {{ f.expiration_date }}
          {% if f.badge %}
            <span class="badge {{ f.badge|lower }}">{{ f.badge }}</span>
          {% endif %}
          <form method="post" action="{% url 'food-change-qty' f.id '-1' %}" class="inline">
            {% csrf_token %}<button type="submit">−1</button>
          </form>
          <form method="post" action="{% url 'food-change-qty' f.id '1' %}" class="inline">
            {% csrf_token %}<button type="submit">+1</button>
          </form>
          <form method="post" action="{% url 'food-delete' f.id %}" class="inline"
                onsubmit="return confirm('Wirklich löschen?');">
            {% csrf_token %}<button type="submit" style="color:red">Löschen</button>
          </form>
        </li>
      {% empty %}<li>–</li>{% endfor %}
    </ul>

    <h3>- MHD über 3 Tage überschritten</h3>
    <ul>
      {% for f in expired_gt_3 %}
        <li>
          {{ f.name }} – {{ f.quantity }} – Ablauf: {{ f.expiration_date }}
          {% if f.badge %}
            <span class="badge {{ f.badge|lower }}">{{ f.badge }}</span>
          {% endif %}
          <form method="post" action="{% url 'food-change-qty' f.id '-1' %}" class="inline">
            {% csrf_token %}<button type="submit">−1</button>
          </form>
          <form method="post" action="{% url 'food-change-qty' f.id '1' %}" class="inline">
            {% csrf_token %}<button type="submit">+1</button>
          </form>
          <form method="post" action="{% url 'food-delete' f.id %}" class="inline"
                onsubmit="return confirm('Wirklich löschen?');">
            {% csrf_token %}<button type="submit" style="color:red">Löschen</button>
          </form>
        </li>
      {% empty %}<li>–</li>{% endfor %}
    </ul>
  </main>

  <footer>
    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}<button type="submit">Abmelden</button>
    </form>
  </footer>
</body>
</html>
